cpdef int calculate_aos(
    double[:],
    double[:],
    double[:],
    double[:],
    double[:],
    int,
    double[:]) nogil
